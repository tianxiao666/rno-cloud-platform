<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hgicreate.rno.mapper.gsm.GsmCoBsicMapper">
    <select id="getCoBsicCellsByAreaIdAndBcch"
            parameterType="com.hgicreate.rno.web.rest.gsm.vm.GsmCoBsicQueryVM"
            resultType="java.util.List">
        SELECT cell_id as cellId,bcch,BSIC from (
         select DISTINCT c1.CELL_ID, c1.bcch , c1.BSIC from RNO_GSM_CELL c1, RNO_GSM_CELL c2
            where c1.BCCH =c2.BCCH
                  and c1.BSIC = c2.BSIC
                  and c1.AREA_ID in (select id from RNO_SYS_AREA where PARENT_ID=#{areaId})
                and c2.AREA_ID in (select id from RNO_SYS_AREA where PARENT_ID= #{areaId})
         ORDER BY  c1.bcch,c1.BSIC)
        where BCCH = #{bcch} and BSIC = #{bsic}
    </select>
    <select id="getCoBsicCellsByAreaId"
            parameterType="com.hgicreate.rno.web.rest.gsm.vm.GsmCoBsicQueryVM"
            resultType="java.util.List">
        select DISTINCT c1.CELL_ID as cellId, c1.bcch , c1.bsic from RNO_GSM_CELL c1, RNO_GSM_CELL c2
        where c1.BCCH =c2.BCCH
        and c1.BSIC = c2.BSIC
        and c1.AREA_ID  in (select id from RNO_SYS_AREA where PARENT_ID=#{areaId})
        and c2.AREA_ID in (select id from RNO_SYS_AREA where PARENT_ID=#{areaId})
        ORDER BY  c1.bcch,c1.BSIC
    </select>
    <select id="queryCommonNcellByTwoCell" parameterType="java.lang.String"
        resultType="java.util.List">
        select * from RNO_GSM_NCELL_RELATION where NCELL_ID = ${sourceCell}
        and CELL_ID in (select CELL_ID from RNO_GSM_NCELL_RELATION where NCELL_ID = #{targetCell})
    </select>
    <select id="queryNcell" parameterType="java.lang.String" resultType="java.util.List">
        select * from RNO_GSM_NCELL_RELATION where CELL_ID = #{sourceCell} and NCELL_ID = #{targetCell}
    </select>
    <select id="getLonLatsByCells" parameterType="java.lang.String" resultType="java.util.List">
        select wmsys.wm_concat(LONGITUDE||','||LATITUDE) as lonlats from RNO_GSM_CELL
        where CELL_ID = #{sourceCell} or CELL_ID = #{targetCell}
    </select>
</mapper>